<rxui:ReactiveUserControl x:Class="ModManager.Views.Mods.ModListView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:ModManager.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="clr-namespace:Avalonia.Xaml.Interactivity;assembly=Avalonia.Xaml.Interactivity"
    xmlns:m="using:ModManager.Models.Mod"
    xmlns:materialIcons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:mod="using:ModManager.Models.Mod"
    xmlns:rxui="http://reactiveui.net"
    xmlns:vm="using:ModManager.ViewModels.Mods"
    d:DesignHeight="800"
    d:DesignWidth="700"
    x:DataType="vm:ModListViewModel"
    x:TypeArguments="vm:ModListViewModel"
    Background="Transparent"
    mc:Ignorable="d">
	<Design.DataContext>
		<vm:DesignModListViewModel />
	</Design.DataContext>
	<UserControl.Styles>
		<Style Selector="TextBox /template/ TextBlock#PART_Watermark">
			<Setter Property="Opacity" Value="0.3" />
		</Style>

		<Style Selector="TreeDataGridTextCell:pointerover /template/ Border#CellBorder > TextBlock">
			<Setter Property="Foreground" Value="{DynamicResource ModListHoveredTextForeground}" />
		</Style>

		<Style Selector="TextBlock.Title:pointerover">
			<Setter Property="Foreground" Value="{DynamicResource ModListHoveredTextForeground}" />
		</Style>

		<Style Selector="Expander /template/ ToggleButton#PART_ToggleButton">
			<!--<Setter Property="ToolTip.VerticalOffset" Value="-2" />
			<Setter Property="ToolTip.Placement" Value="Top" />-->
			<Setter Property="ToolTip.ShowDelay" Value="500" />
			<Setter Property="ToolTip.Tip" Value="Toggle Filter" />
		</Style>

		<!--<Style Selector="TreeDataGridRow[IsSelected=false] /template/ TreeDataGridCellsPresenter#PART_CellsPresenter:pointerover">
			<Setter Property="Background" Value="{DynamicResource ModListHoveredCellBackground}" />
			<Setter Property="BorderBrush" Value="{DynamicResource ModListHoveredCellBorder}" />
		</Style>

		<Style Selector="TreeDataGridRow[IsSelected=true] /template/ TreeDataGridCellsPresenter#PART_CellsPresenter:pointerover">
			<Setter Property="Background" Value="{DynamicResource ModListHoveredCellSelectedBackground}" />
			<Setter Property="BorderBrush" Value="{DynamicResource ModListHoveredCellBorder}" />
		</Style>-->

		<Style x:DataType="mod:IModEntry" Selector="TreeDataGridRow">
			<Style Selector="^/template/ TreeDataGridCellsPresenter#PART_CellsPresenter">
				<Setter Property="Background" Value="{Binding ListColor, Converter={StaticResource ModBackgroundColorConverter}}" />
			</Style>

			<Style Selector="^:pointerover /template/ TreeDataGridCellsPresenter#PART_CellsPresenter">
				<Setter Property="Background" Value="{Binding PointerOverColor, Converter={StaticResource ModBackgroundColorConverter}, ConverterParameter='ModListHoveredCellBackground'}" />
			</Style>

			<Style Selector="^:selected /template/ TreeDataGridCellsPresenter#PART_CellsPresenter">
				<Setter Property="Background" Value="{Binding SelectedColor, Converter={StaticResource ModBackgroundColorConverter}, ConverterParameter='TreeDataGridSelectedCellBackgroundBrush'}" />
			</Style>

			<Style Selector="^:selected:pointerover /template/ TreeDataGridCellsPresenter#PART_CellsPresenter">
				<Setter Property="Background" Value="{Binding PointerOverColor, Converter={StaticResource ModBackgroundColorConverter}, ConverterParameter='ModListHoveredCellBackground'}" />
			</Style>

			<!--<Setter Property="ContextFlyout" Value="{StaticResource ModContextFlyout}" />-->
		</Style>

	</UserControl.Styles>
	<Grid RowDefinitions="auto,*">
		<Grid ColumnDefinitions="auto,auto,auto,*">
			<TextBlock Padding="4"
			    VerticalAlignment="Center"
			    Classes="Title"
			    Text="{Binding Title}"
			    TextAlignment="Left" />
			<Expander Name="FilterExpander"
			    Grid.Column="1"
			    Margin="0"
			    VerticalAlignment="Center"
			    BorderThickness="0"
			    ExpandDirection="Right"
			    Theme="{StaticResource FilterButtonExpander}">
				<controls:EnhancedTextBox Name="FilterTextBox"
				    Width="200"
				    Margin="0"
				    Padding="0"
				    VerticalContentAlignment="Center"
				    AcceptsReturn="False"
				    AcceptsTab="False"
				    ContextFlyout="{StaticResource EnhancedTextBoxContextFlyout}"
				    MaxLines="1"
				    TextAlignment="Left"
				    UseFloatingWatermark="False"
				    Watermark="{Binding FilterPlaceholderText}" />
			</Expander>

			<TextBlock Grid.Column="2"
			    Margin="4,0,0,0"
			    HorizontalAlignment="Left"
			    VerticalAlignment="Center"
			    Text="{Binding FilterResultText}" />
		</Grid>
		<TreeDataGrid Name="ModsTreeDataGrid"
		    Grid.Row="1"
		    AutoDragDropRows="True"
		    Background="Transparent"
		    Focusable="True"
		    Source="{Binding Mods}" />
	</Grid>
</rxui:ReactiveUserControl>
